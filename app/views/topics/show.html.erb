<div class="pb-2">
    <h1 class="text-lg"><%= @topic.title %></h1>
    <h2 class="text-med text-xs"><%= time_ago_in_words(@topic.created_at) %> | <%= link_to @topic.author.email %></h2>

    <% @topic.posts.select{|p| p.persisted? }.each_with_index do |post, index| %>
        <% if index.zero? %>
            <div class="py-3">
                <div class="px-1"><%= post.body %></div>
            </div>
        <% else %>
            <div class="bg-yellow-500 py-1 px-2 my-1">
                <div class="flex justify-between">
                    <div class="text-sm font-medium link"><%= link_to post.author.email %></div>
                    <div class="text-xs text-yellow-900"><%= time_ago_in_words(post.created_at) %></div>
                </div>
                <div><%= post.body %></div>
            </div>
        <% end %>

    <% end %>
</div>

<% if @new_post.errors.any? %>
<ul class="bg-red-500 py-2">
    <% @new_post.errors.full_messages.each do |message|%>
        <li><%= message %></li>
    <%end%>
</ul>
<%end%>

<%= form_with(model: @new_post, url: [@topic], method: :put, class: "py-2") do |f| %>
    <%= f.label :body, "body", class: "block font-semibold" %>
    <%= f.text_area :body, class: "form-textarea border-none w-6/12 py-1 px-1 mb-3 bg-yellow-100" %>

    <%= f.submit "reply", class: "block btn" %>
<% end %>

<%= link_to "see all topics", topics_path, class: "link" %>
